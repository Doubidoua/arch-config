define("jsonrcp",[],function(){return function(e,t){function n(t,n,r,i){var s=1e4+(e.Math.random()*1e3+1)+(new e.Date).getTime(),o={};return o.method=n,o.params=r,o.id=s,o.jsonrpc="1.0",$.ajax({type:"POST",encoding:"UTF-8",dataType:"json",contentType:"application/x-www-form-urlencoded;charset=ISO-8859-15",url:t,data:e.JSON.stringify(o)}).done(function(e){i(e)}).fail(function(e,t,n){}),s}return n}(window)}),define("validator",[],function(){var e;return e={EMAIL_REG:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/gi,email:function(e){return e.match(this.EMAIL_REG)}},e}),define("login",["jsonrcp","validator"],function(e,t){return function(n){var r="//"+document.location.hostname.replace(/^([^\.]{1,})/,"www")+"/Account/login/verify",i=!1,s=!1,o=2021,u=2020,a=2122,f=2030,l=2142,c=[],h=function(e){return function(t){var r=function(e){t.showPopinLogin(e)},i=function(e){return e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),t.quickRegister(t),!1},s=function(){n.$C.set("#signin").off("click").click(r),n.$C.set("#submitQuickPopin").off("click").click(i)};t.customPopin(e),n.setTimeout(s,100)}(this),this},p=null,d=function(t){t&&typeof t.preventDefault=="function"&&(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation()),e(r,"forgottenPassPopin",[],function(i){n.$C.$html.addClass("on"),n.$C.$body.addClass("signinbox"),n.$C.set(".signin .popincontent").html(i.result),n.$C.set("#submitForgottenPopin").click(function(){return t&&typeof t.preventDefault=="function"&&(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation()),e(r,"forgottenPass",[n.$C.get("#lostPassEmail")[0].value],function(e){if(e.result.code&&e.result.code==="ok")p||(p=new g),p.showPopinLogin(),n.setTimeout(function(){n.$C.set("#loginemail")[0].value=e.result.mail,n.$C.set("#globalErr").removeClass("msg iconno").addClass("active").text(e.result.msg)},1e3);else{var t="champs invalide";c[e.result.code]!==undefined&&(t=c[e.result.code]),n.$C.set("#emailwarn").text(t),n.$C["#lostPassEmail"].addClass("required")}}),!1})})},v=function(i){return i&&typeof i.preventDefault=="function"&&(i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation()),function(i){var s=function(t){return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e("//"+document.location.hostname.replace(/^([^\.]{1,})/,"www")+"/Account/login/verify","quickRegisterPopin",["login"],function(e){e.result.code&&e.result.code==="ok"&&(p||(p=new g),p.sessTrash(e.result.page))}),!1},a=function(t){if(t.result.code&&t.result.code==="ok"){i.closePopin(),n.shore.set("userData",t.result.user);if(t.result.action){var r=t.result.action;e(r.url,r.method,r.params,function(){n.location.reload()})}else t.result.redirect.found==="OK"?n.location=t.result.redirect.url:n.location.reload();t.result.lastPage&&(n.location.href=t.result.lastPage)}},l=function(i){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation();var s=$("#loginemail")[0].value,l=$("#loginpass")[0].value,h=$("#stayConnected").is(":checked"),p=!0,d="",v="",m=t.email(s);return m||(n.sendToGTM("event","button","click","jemeconnecte/bademail"),d=c[o],p=!1),s.length===0&&(n.sendToGTM("event","button","click","jemeconnecte/emptymail"),d=c[u],p=!1),l.length===0&&(n.sendToGTM("event","button","click","jemeconnecte/emptyemailpwd"),v=c[f],p=!1),p?e(r,"login",[s,l],function(e){if(e.result.code&&e.result.code==="ko"){n.sendToGTM("event","button","click","jemeconnecte/loginfail"),n.$C.get("#globalErr").addClass("active msg iconno").text("email ou mot de passe invalide");return}n.shore.clear("welcomebox"),h&&n.shore.set("auto_log",!0),a(e)}):(v.length>0&&(n.$C.get("#sign-pwd-warn").text(v),n.$C.get("#loginpass").addClass("required")),d.length>0&&(n.$C.get("#sign-mail-warn").text(d),n.$C.get("#loginemail").addClass("required"))),!1},h=function(e){n.$C.$html.addClass("on"),n.$C.$body.addClass("signinbox"),n.$C.set(".signin .popincontent").html(e.result),n.$C.set("#forgotten").click(d),n.$C.set("#registerpopin").click(s),n.$C.set("#submitLoginPopin").click(l),n.sendToGTM("event","button","click","jemeconnecte/top-nav"),n.common.adjustPopin()};e(r,"buildPopin",[],h)}(this),!1},m=function(){s||(s=!0,e(r,"getStatus",[],function(t){i=t.result.connected;var s=!1;n.shore.get("auto_log",function(t){s=t,s==="true"&&i===!1&&n.shore.get("userData",function(t){var i=JSON.parse(t),s=i.id,o=i.autoconnectKey;e(r,"loginByKey",[s,o],function(e){e.result.code&&e.result.code==="ok"&&n.location.reload()})})})}))},g=function(){var e=!0;return typeof isInDEGMD!="undefined"&&isInDEGMD===!0&&(e=!1),e&&m(),new g.fn.init};return c[o]='Champs "Email" invalide',c[u]='Champs "Email" requis',c[a]='votre "Email" existe',c[f]='Champs "Mot de passe" requis',c[l]='"Email" inconnu',g.fn=g.prototype={init:function(){return function(e){e.sessTrash=function(){return h.apply(e,arguments)},e.showPopinLogin=function(){return v.apply(e,arguments)},e.userIsConnected=function(){return i}}(this),this},popin:function(e){var t="";return e&&(e.title&&(t+='<p class="h2 big hardware',e.iconCss&&(t+=" ",t+=e.iconCss),t+='">',t+=e.title,t+="</p>"),e.msgError&&(t+='<p id="globalErr" class="max10 fade iconno msg after active">',t+=e.msgError,t+="</p>"),e.description&&(t+='<p class="h4">',t+=e.description,t+="</p>"),t+='<div class="tablevmiddlechild inputfull">',e.content&&(t+=e.content),e.footer&&(t+='<div class="footer">',t+=e.footer,t+="</div>"),t+="</div>"),h.call(this,t),this},quickRegister:function(i){var s=!0,f="",l=n.$C.set("#quickemail").val(),h=n.$C.set("#src").val();return n.$C["#quickemail"].removeClass("required"),t.email(l)||(f=c[o],s=!1),l.length===0&&(f=c[u],s=!1),s?function(t){var i=function(r){if(r.result.code&&r.result.code==="ok"){n.shore.set("userData",r.result.user),n.$C.set(".popincontent").html("<p class='h2 big hardware' >"+r.result.title+"</p><p class='h4'><strong>"+r.result.msg+"</strong></p>");if(r.result.action){var i=r.result.action;e(i.url,i.method,i.params,function(){n.setTimeout(function(){n.location.reload()},3e3)})}else n.setTimeout(function(){n.location.reload()},3e3);r.result.src&&r.result.src==="internal-addFavoriteWhere"&&$("#isFavorite").addClass("saved")}else f="champs invalide",c[r.result.code]!==undefined&&(f=c[r.result.code]),n.$C.set("#emailwarn").text(f),n.$C["#quickemail"].addClass("required"),a===r.result.code&&function(){n.setTimeout(function(){t.showPopinLogin()},1e3)}()};e(r,"quickRegister",[l,h],i)}(i):(n.$C.set("#emailwarn").text(f),n.$C["#quickemail"].addClass("required")),this},showPopinLogin:null,customPopin:function(e){return n.$C.$html.addClass("on"),n.$C.$body.addClass("signinbox"),n.$C.set(".signin .popincontent").html(e),n.common.adjustPopin(),this},closePopin:function(){return n.$C.$html.removeClass("on"),n.$C.$body.removeClass("signinbox"),n.setTimeout(function(){n.$C.set(".popincontent .signin").empty()},1e3),this},logout:function(t){t&&(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation());var i=function(){n.shore.clear("userData"),n.shore.clear("auto_log");var e=n.location.pathname.split("/");e[1]==="profile"||e[0]==="fiche"?n.location.href="/":n.location.reload()};return e(r,"logout",[],i),!1},sessTrash:null},g.fn.init.prototype=g.fn,g}(window)}),define("popin",[],function(){return function(e,t){var n=768,r=function(){var t=e.innerHeight;t<=n&&e.$C.get("html, body").animate({scrollTop:e.$C.$body.offset().top},1e3)},i=function(e,t,n){return new i.fn.init(e,t,n)};return i.fn=i.prototype={init:function(t,n,r){this.name=n;var i=this,s=function(){i.openPopin()},o=function(){i.closePopin()},u=t&&t.result?t.result.page||(typeof t.result=="string"?t.result:""):"",a="popin "+this.name;return r&&(a+=" ",a+=r),u===""&&(u+='<div class="popin ',u+=this.name,u+='"><div class="popinbox boxinner"><button class="closepopin btnclosepopin"></button><p class="h4">Impossible d\'afficher le contenu de cette fenêtre !</p>Vous pouvez tenter de résoudre le problème en rafraîchissant la page.</div></div>'),e.$C.get("#generic_popin").attr("class",a).html(u).find(".closepopin").click(o),e.setTimeout(s,200),this},name:"",openPopin:function(){return e.$C.$html.addClass("on"),e.$C.$body.addClass(this.name+"box"),r(),this},closePopin:function(){return e.$C.$html.removeClass("on"),e.$C.$body.removeClass(this.name+"box"),this}},i.fn.init.prototype=i.fn,i}(window)}),define("devis",["jsonrcp","popin"],function(e,t){return function(n,r){var i=null,s=function(e){var t=n.$C.set(".typedevis");if(!i&&e){var r=e.result,s=n.JSON.parse(r),o=t.data("id"),u="",a="<option>Demande de devis travaux</option>";for(var f in s)u=o==f?"selected ":"",a+="<option ",a+=u,a+='value="',a+=f,a+='">',a+=s[f],a+="</option>";i=$(a)}t.html(i)},o="/Site/devis/send-to-boa",u=function(){if(n.$C.get("#devisarea").length===0){var r=n.$C.get("#devisBOApopin").data("devis");i||e(o,"getCategories",[],s),e(o,"getDevisHtml",[r],function(e){t(e,"contactform","ffpopin"),s()})}else n.$C.$body.animate({scrollTop:n.$C.get("#devisarea").offset().top},2e3)},a=$('<p class="msg success fade max10 iconyes after active"><strong>Merci.</strong> Votre demande à bien été prise en compte.</p>'),f=$('<p class="msg fade max10 iconno after active"><strong>Erreur.</strong> Merci de réessayer.</p>'),l=function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var r=$(this),i=r.serializeArray();return function(t){e(o,"sendToBOA",[i],function(e){var r=n.JSON.parse(e.result);n.$C.set(".msg").removeClass("active");if(r.status)t.append(a);else{if(r.hasOwnProperty("champs")){errors=r.champs.split(" ");for(var i=0,s=errors.length;i<s;i++)n.$C.set('#devisForm [name="'+errors[i].replace(",","")+'"]').addClass("required")}t.append(f)}})}(r),!1},c=function(){n.$C.set("#devisForm").submit(l),n.$C.get("input, select").focus(function(){$(this).removeClass("required")}),n.$C.get(".warning").hover(function(){$(this).parent().find("input").removeClass("required")}),n.$C.get("#devisBOApopin").click(u)},h=function(){return c(),this};return h()}(window)}),define("geoloc",["jsonrcp"],function(e){return function(t,n){function r(){var t=navigator.geolocation,n={enableHighAccuracy:!0,timeout:1e4,maximumAge:2e4},r=function(){var t=arguments[0].coords;e("//"+document.location.hostname.replace(/^([^\.]{1,})/,"www")+"/Account/login/verify","userLocation",[t.latitude,t.longitude],function(e){})},i=function(){},s=function(e,s){(function(e,s){var o=function(t){r(t),e(t)},u=function(t){i(t),typeof s=="function"?s({failure:"geoloc",error:t}):e(null)};t.getCurrentPosition(o,u,n)})(e,s)};return this.startGeoLocation=function(e,t){return s(e,t),this},this}return r()}(window)}),define("async",[],function(){function n(e){var t,n;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}function r(t,n){var r=/!(.+)/,i=t.replace(r,""),s=r.test(t)?t.replace(/.+!/,""):e;return i+=i.indexOf("?")<0?"?":"&",i+s+"="+n}function i(){return t+=1,"__async_req_"+t+"__"}var e="callback",t=0;return{load:function(e,t,s,o){if(o.isBuild)s(null);else{var u=i();window[u]=s,n(r(e,u))}}}}),define("propertyParser",[],function(){function n(t){var n=e.exec(t),i={};while(n&&n.length>2)i[n[1]]=r(n[2]||n[3]),n=e.exec(t);return i}function r(e){return t.test(e)?e=e.replace(t,"$1").split(","):e==="null"?e=null:e==="false"?e=!1:e==="true"?e=!0:e===""||e==="''"||e==='""'?e="":isNaN(e)||(e=+e),e}var e=/([\w-]+)\s*:\s*(?:(\[[^\]]+\])|([^,]+)),?/g,t=/^\[([^\]]+)\]$/;return{parseProperties:n,typecastVal:r}}),define("goog",["async","propertyParser"],function(e,t){function r(e){var r=n.exec(e),i={moduleName:r[1],version:r[2]||"1"};return i.settings=t.parseProperties(r[3]),i}var n=/^([^,]+)(?:,([^,]+))?(?:,(.+))?/;return{load:function(e,t,n,i){if(i.isBuild)n(null);else{var s=r(e),o=s.settings;o.callback=n,t(["async!"+(document.location.protocol==="https:"?"https":"http")+"://www.google.com/jsapi"],function(){google.load(s.moduleName,s.version,o)})}}}}),define("search",["geoloc","jsonrcp","goog!maps,3,other_params:libraries=places"],function(e,t){return function(n,r){var i=function(i){var s=$(i),o=null,u=null,a,f,l,c,h,p,d,v,m,g,y,b="fr",w=[],E=[],S=["google","osm"],x=function(e){w=[];var t=e.address_components,n=t.length,r;m=e.formatted_address,f=e.geometry.location.lat(),l=e.geometry.location.lng(),w.lat=f,w.lng=l;for(var i=0;i<n;i++)r=t[i],w[r.types[0]]=r.long_name,r.types&&r.types.length>0&&r.types[0]=="administrative_area_level_2"&&(d=r.short_name);return u=s.val(),e},T=function(){var e=x(a.getPlace());return typeof o=="function"&&o(e),e},N=function(){a!==r&&(a.unbindAll(),google.maps.event.clearInstanceListeners(a),$(".pac-container").remove()),a=new google.maps.places.Autocomplete(s[0]);var e=$("#countryChoose").val();if(typeof e=="undefined"||e==="")e=b;a.setComponentRestrictions({country:e}),google.maps.event.addListener(a,"place_changed",T),n.$C.set(".pac-container").length===0&&C()},C=function(){s.keyup(function(){L()})},k=function(e){(function(t){var r="",i=n.JSON.parse(e.result),s=n.$C.get("#"+t),o=function(){var e=$(this),r=e.data("id");n.$C.get("#"+t).attr("data-id",r).val(E[r].properties.name+", "+E[r].properties.city+" ("+E[r].properties.postcode+")"),e.parent().removeClass("active")};E=i.features;for(var u=0,a=E.length;u<a;u++)if(E[u].properties.street){var f=n.JSON.stringify(E[u]);r+='<li data-id="',r+=u,r+='">',r+=E[u].properties.name||"",r+=", ",r+=E[u].properties.city||"",r+=" (",r+=E[u].properties.postcode||"",r+=")</li>"}s.parent().find("ul").html(r).addClass("active").find("li").click(o)})(s.attr("id"))},L=function(){t("/Site/default/osm-suggestions","getSuggestions",[s.val()],k)},A=function(){f=l=d=m=v=g=y=null},O=new google.maps.places.AutocompleteService,M=new google.maps.places.PlacesService(s[0]),_=function(e,t){!e||e.length===0?t(null):function(t){var n=function(e){t(x(e))};D(e[0].reference,n)}(t)},D=function(e,t){(function(t){M.getDetails({reference:e},function(e,n){t(e)})})(t)},P=function(e,t){(function(t){var n=function(e,n){_(e,t)};O.getPlacePredictions({input:e,offset:e.length,componentRestrictions:{country:b}},n)})(t)},H=new google.maps.Geocoder,B=function(e,t,n){e&&e.coords?function(t,n){var r=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);H.geocode({latLng:r},function(e,r){r==google.maps.GeocoderStatus.OK&&e.length>0?t(x(e[0])):typeof n=="function"?n({failure:"geocode",error:e,status:r,GeocoderStatus:google.maps.GeocoderStatus}):t(null)})}(t,n):typeof n=="function"?n({failure:"pos",error:e}):t(null)},j=function(t,n){(function(t,n){var r=function(e){B(e,t,n)};e.startGeoLocation(r,n)})(t,n)};return this.updatePlace=function(e){e=typeof e=="function"?e:function(){},A();var t=s.val();return t&&t.length>0?s.datas?s.datas.reference?function(e,t){var n=function(n){x(n),t.datas.label=m,t.datas.lat=f,t.datas.lng=l,t.datas.cityseo=h,t.datas.radius=v,t.datas.city=g,t.datas.of=y,e(t.datas)};D(t.datas.reference,n)}(e,s):!s.datas.city&&(!s.datas.lat||!s.datas.lng)?P(t,e):(m=s.datas.label,f=s.datas.lat,l=s.datas.lng,h=s.datas.cityseo,v=s.datas.radius,g=s.datas.city,y=s.datas.of,e(s.datas)):P(t,e):e(null),this},this.isUpdate=function(){return s.val()==u},this.isEmpty=function(){return u=u||"",($("#where").val()?$("#where").val().length:0)===0&&($("#who").val()?$("#who").val().length:0)===0},this.getLat=function(){return f},this.getLng=function(){return l},this.getWhatUrl=function(){return c},this.setWhatUrl=function(e){c=e},this.getWhereUrl=function(){return h},this.getNeedGeo=function(){return $("#fgeoloc").val()==="1"?1:0},this.setWhereUrl=function(e){h=e},this.getLabel=function(){return m},this.getCity=function(){return g},this.getOf=function(){return g},this.getDepartment=function(){return d},this.getRadius=function(){return v},this.getInput=function(){return s},this.getGeoLoc=function(e,t){return j(e,t),this},this.getPlaceByReference=function(e,t){return D(e,t),this},this.getAddressInfo=function(){return S[0]=="google"?N():C(),this},this.getRow=function(e){return e&&n.parseInt(e,10)>=0?this.getFeature(n.parseInt(e,10)):w},this.focusOut=function(e){return typeof e=="function"&&(o=e),this},this.getFeature=function(e){var t=[];return t.street_number=E[e].properties.hasOwnProperty("housenumber")?E[e].properties.housenumber:"",t.route=E[e].properties.street,t.locality=E[e].properties.city,t.postal_code=E[e].properties.postcode,t.lat=E[e].geometry.coordinates[0],t.lng=E[e].geometry.coordinates[1],t},this};return i}(window)}),define("cdhautocomplete",["jsonrcp"],function(e){return function(t,n){var r=function(n,r){var i=this,s=null,o="cdh."+n,u=864e5,a=10,f={expiration:(new t.Date).getTime()+u},l=2e4,c=function(e){if(e&&t.JSON&&e.length<l){e=t.JSON.parse(e);var n=(new t.Date).getTime();if(!e||!e.expiration||e.expiration<n)e={expiration:n+u};f=e}for(var r=0,i=v.length;r<i;r++)typeof v[r]=="function"&&v[r]();d=!0},h=function(e,t){return(e.date||0)<(t.date||0)?1:-1},p=function(e,n){var r=[],i=0,s="",u=0,l={};n.date=(new t.Date).getTime(),f[e]=n;for(s in f)r[i]={storage:f[s],value:s,date:f[s].date||0},i++;r.sort(h);for(;u<a;u++){if(typeof r[u]=="undefined")break;l[r[u].value]=r[u].storage}t.shore.set(o,l)},d=!1,v=[],m=!1,g=!1,y=function(){g||function(n){var r=function(e){n!=="expiration"&&p(n,e),g||i.callback($.extend(!0,{},f[n]))},s=[n];i.searchType=="where"&&s.push(t.$C.get("#proxy").is(":checked")),e("/data/auto-complete",i.searchType,s,r)}(i.value),m=!1},b=!1,w=function(){d?(g=!1,f[i.value]?i.callback($.extend(!0,{},f[i.value])):m||(m=!0,s=t.setTimeout(y,i.timeout))):(b=!0,v[v.length]=w,t.shore.get(o,c))};return t.shore.get(o,c),this.get=function(e,t){return this.value=e,this.callback=typeof t=="function"?t:this.callback,w(),this},this.interrupts=function(){return t.clearTimeout(s),m=!1,g=!0,this.callback=function(){},this},this.searchType=n,this.value="",this.callback=function(){},this.timeout=r||166,this.clearCache=function(e,n,r){return d?(typeof e=="string"?(delete f[e],r?this.update(e,n):typeof n=="function"&&n()):(f={expiration:(new t.Date).getTime()+u},typeof n=="function"&&n()),t.shore.set(o,f)):v[v.length]=function(e,t,n,r){return function(){e.clearCache(t,n,r)}}(this,e,n,r),this},this.update=function(e,t){return function(t,n,r){t.timeout=0;var i=function(e){t.timeout=n,r&&typeof r=="function"&&r(e)};t.get(e,i)}(this,this.timeout,t),this},this};return r}(window)}),define("autocomplete",["search","cdhautocomplete","jsonrcp","login"],function(e,t,n,r){return function(i,s){var o=$('<li class="location"><strong class="icontarget">Me localiser</strong></li>'),u=$("#logo"),a=$("#proxy"),f=a.is(":checked"),l=function(){f=a.is(":checked")},c=function(e,t){return function(e,t,n){var r=function(t){return t&&t.type=="keydown"&&(e.$where?e.$where.required(!0):e.$parent&&e.$parent.required(!0),e.required(!0)),n.apply(e,arguments)},i=function(t){h(e,t)};t.off("keyup").keydown(r).keyup(r).focus(r).blur(i)}(this,e,t),this},h=function(e,t){return $(t.relatedTarget).attr("data-stopPropagation")||(e.hideAutoComplete=!0,function(e){i.setTimeout(function(){e.hideAutoComplete&&(e.$where?e.$where.required(!0):e.required(!0),e.cdh&&(e.cdh.interrupts(),e.favoriteProcessing=!1),e.focusAutoComplete())},100)}(e)),e},p=null,d="/Account/data/jaime",v=function(e,t,n){return n?y(e,t):e.displayAutoComplete.call(e,t),e.favoriteProcessing=!1,e},m=function(e,t,n,i,s){return function(e,t,n,i,s){var o="",u=!1,a=null,f=null;n&&n.result&&n.result.code=="ok"?(i?(o="Adresse ajoutée",a="iconsv",f="validated"):(o="Adresse supprimée",a="iconbasket",f="deleted"),u=!0):n.result.code=="ko"&&(n.result.msg=="session_trash"?(p||(p=new r),p.sessTrash(n.result.page)):n.result.msg=="limit_reached"?o="Limite: 6 favoris":o="Erreur"),n.result.favorites&&(e.favorite.array=n.result.favorites,e.favorite.uniqueObjects(["lib","adresse"])),o&&D(e,o,f,a),e.cdh.clearCache(),v(e,n,s)}(e,t,n,i,s),e},g=function(e,t){return function(e,t,r){var i=$(t),s=i.parent(),o=s.hasClass("favorite"),u=s.attr("data-id"),a=0,f=function(t){m(e,r,t,!0)},l=function(t){m(e,r,t)},c=null;if(u)if(!e.favoriteProcessing){e.favoriteProcessing=!0;if(o){c=e.favorite.getBy("id",u),a=c.length;for(var h=0;h<a;h++)e.history.array[e.history.array.length]={where:c[h].adresse,id:c[h].id,lat:c[h].geoy,lng:c[h].geox,lib:c[h].lib,type:c[h].type,category:c[h].category,city:c[h].city};n(d,"delFavoriteWhere",c,l)}else c=e.history.getBy("id",u),a=c.length,n(d,"addFavoriteWhere",c,f)}else D(e,"En cours",null,"iconwait");else D(e,"Erreur")}(e,t,e.$input.val()),e},y=function(e,t){var n=/^where$/i.test(e.type);return t&&t.result&&(t.result.favorites&&(e.favorite.array=t.result.favorites,e.favorite.uniqueObjects(["lib","adresse"])),t.result.history&&e.history.mergeFirst(t.result.history)),e.history.uniqueObjects(n?["where"]:["what","where"]).reduce(e.favorite.array,{where:"adresse",lat:"geox",lng:"geoy"}),T(e),n&&w(e),e},b={},w=function(e){if(e&&e.favorite&&e.favorite.array){var t=0,n=e.favorite.array.length;for(var r in b){var i=!1;for(t=0;t<n;t++)if(e.favorite.array[t].adresse==b[r].datas.adresse){i=!0;break}i?b[r].$favorite.addClass("saved"):b[r].$favorite.removeClass("saved")}}return e},E=function(e,t){return b[t]&&function(e,t){var n=function(){S(e,b[t])};b[t].$favorite.click(n)}(e,t),e},S=function(e,t){return t&&function(e,t,n){var r=function(e){n?t.$favorite.removeClass("saved"):e&&e.id&&(t.datas.id=e.id)};x(e,t.datas,n,r)}(e,t,t.$favorite.hasClass("saved")),e},x=function(e,t,r,i){return t&&function(e,i){var s=t.adresse||"",o=function(e){if(typeof i=="function"){var t=null;if(e&&e.result&&e.result.favorites)for(var n=0,r=e.result.favorites.length;n<r;n++)if(e.result.favorites[n].adresse==s){t=e.result.favorites[n];break}i(t)}},u=function(t){m(e,s,t,!0,!0),o(t)},a=function(t){m(e,s,t,!1,!0),o(t)};r?n(d,"delFavoriteWhere",[t],a):n(d,"addFavoriteWhere",[t],u)}(e,i),e},T=function(e){return i.shore.set(e.historyName,e.history.limit(10)),e},N=function(e,t,n,r){t=t||{},r=r||"";var i="",s=t.label||t[e]||t.adresse||"",o=t.where||"",u=t.lib,a=t.name?t.name+" : ":"",f=t.category||t.cat||null,l=t.categseo||null,c=t.cityseo||null,h="",p=/^where$/i.test(e),d=p?33:55,v={label:s,where:o,cat:f,categseo:l,lat:t.lat||t.geox,lng:t.lng||t.geoy,type:/^favorite$/i.test(r)?"proxy":t.type,radius:t.radius,city:t.city,cityseo:c,id:t.id,reference:t.reference,url:t._urlDetails,user:t.user,date_add:t.date_add,lib:u},m=!1;if(s.length>0){for(var g in v)/^(string|number)$/i.test(typeof v[g])&&(h+="data-",h+=g,h+='="',h+=v[g],h+='" ');i+="<li ",i+=h,/^favorite$/i.test(r)?(i+='class="favorite"><button type="button" class="iconsv btnnoskin" data-stopPropagation="true"></button><strong>',i+=p?"Où":"Qui",i+=" : </strong> ",i+=u||s,d-=a.length):(/^history$/i.test(r)?p?(i+='class="history"><button type="button" class="iconsv btnnoskin" data-stopPropagation="true"></button><strong>Où : </strong>',d-=5):(i+="><strong>Qui : </strong>",m=!0):i+=">",o.length>15&&(o=o.substring(0,12)+"...",d=33),s.length>d&&(s=s.substring(0,d-2)+"..."),i+=s.replace(n,"<span>$&</span>")),m&&t.type=="proxy"&&o.length>0&&(i+=" <strong>près de : </strong> ",i+=o),f&&!p&&(i+='<span class="icon_what_autocomplete C',i+=t.category,i+='"></span>'),i+="</li>"}return i},C=function(e){var t=e,n=function(){M.apply(t,arguments)},r=function(e){_.apply(t,arguments)};e.inputSearch.getGeoLoc(n,r)},k=function(e,t,n){n||this.focusAutoComplete();var r=$(e);if(r.hasClass("location")){var i=this,s=function(){M.apply(i,arguments)},o=function(e){_.apply(i,arguments)};this.inputSearch.getGeoLoc(s,o)}else{var u=r.attr("data-where");u!=="Ma position"&&$("#fgeoloc").remove(),this.lastLabel=r.attr("data-label")||"",this.editInput(r,t,n),u&&u.length>0&&this.$where&&(this.$where.lastLabel=u,this.$where.editInput(r,t,n))}return this},L=function(e){return e&&e.id==this.getDatas("id")&&this.setDatas({label:e.formatted_address,lat:e.geometry.location.lat(),lng:e.geometry.location.lng()}),this},A=function(e){u.attr("class",e&&e.length>0?"right icon_what_field C"+e:"right icon_what_field")},O=function(e){return this.$where.inhibits=e,this.$where.fromWhat=!0,this.navPosition=-1,this.$where.navPosition=-1,this.$where.$input.focus(),this.inhibits=!1,this},M=function(){var e=this.inputSearch.getLabel();return $("#fgeoloc").remove(),this.setDatas({label:e,lat:this.inputSearch.getLat(),lng:this.inputSearch.getLng()}),this.$input.val(e),a.attr("checked",!0),a[0].setAttribute("checked",!0),a[0].checked=!0,document.location.search.indexOf("geolocneed=1")>-1&&$("#search").submit(),this},_=function(e){var t="";if(e&&e.error&&e.error.message&&e.error.message.indexOf("Only secure origins are allowed")===0){var n=$("#search"),r=i.location.host;n.find("#fgeoloc").remove(),n.attr("action",r.replace(/([^\.]+).(.*)/,"https://www.$2")+"/search"),n.append('<input type="hidden" id="fgeoloc" name="fgeoloc"  value="1">'),$("#where").val("Ma position"),t="Vous serez localisé pendant la recherche"}else e&&e.failure&&/^geoloc$/i.test(e.failure)?t="La localisation n'est pas active":t="échec de La localisation";return D(this,t,null,"icontarget")},D=function(e,t,n,r){return i.clearTimeout(e.warningTimeout),n=n&&n!=="warning"?"warning "+n:"warning",r=r||"iconwarning",typeof e.required!="undefined"&&(e.$warning.removeClass().addClass(n),e.$warningText.removeClass().addClass(r).text(t),e.required(),function(e){var t=function(){e.required(!0)};e.warningTimeout=i.setTimeout(t,e.warningTimeUp)}(e)),e},P=function(){return this.array=[],this},H=function(e,t,n){return new H.fn.init(e,t,n)};return H.fn=H.prototype={$input:null,$content:null,$warning:null,$warningText:null,$where:null,$parent:null,inputSearch:null,init:function(n,r,s){this.history=new P,this.favorite=new P,this.type=s||"where",this.historyName=this.type+"LastHistory",this.favoriteName=this.type+"LastFavorite",this.$content=$(r||"#whereDropDown"),this.cdh=new t(this.type);var o=this,u=function(e){y(o,e)},a="";return this.cdh.clearCache("",u,!0),/^what$/i.test(this.type)?(this.$input=$(n),a=this.$input.val(),this.$where=H("#where"),this.inputSearch=this.$where.inputSearch,this.$where.$parent=this,this.setDatas({label:a,cat:this.$input.attr("data-cat"),city:this.$input.attr("data-city")})):(this.inputSearch=new e(n||"#where"),this.$input=this.inputSearch.getInput(),a=this.$input.val()),this.lastLabel=a,this.placeholder=this.$input.attr("placeholder"),this.$warning=this.$input.nextAll(".warning"),this.$warningText=this.$warning.find("strong"),c.call(this,this.$input,this.changeField),this.editInput(this.$input,null,!0),function(e){var t=function(t){if(i.JSON&&t&&t.length>0){var n=i.JSON.parse(t);n.length>0&&e.history.mergeFirst(n)}},n=function(t){if(i.JSON&&t&&t.length>0){var n=i.JSON.parse(t);n.length>0&&e.favorite.mergeFirst(n)}};i.shore.get(e.historyName,t)}(this),this},type:"",cdh:null,available:!0,changeField:function(e){this.$where?this.$where.focusAutoComplete():this.$parent&&this.$parent.focusAutoComplete();var t=!this.navigation(e);if(!t)e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();else if(this.available){var n=this,r=function(){n.displayAutoComplete.apply(n,arguments)};this.cdh&&this.cdh.get(this.$input.val(),r)}else this.displayAutoComplete({result:{}}).available=!0;return t},historyName:"",history:null,favoriteName:"",favorite:null,showFavories:!0,favoriteProcessing:!1,manageFavoritesOut:function(e){var t=this,n=0,r=e.length,s=function(r,i){var s=e[n]+r;if(!b[s]){var o=$(i);b[s]={$favorite:o,datas:{id:o.attr("data-id"),adresse:o.attr("data-adresse"),geox:o.attr("data-geox"),geoy:o.attr("data-geoy")}},E(t,s)}};for(;n<r;n++)i.$C.get(e[n]).each(s);return this},displayAutoComplete:function(e){if(e.result){var t=this.$input.val(),n=t!==this.lastLabel;n&&(this.setDatas(),/^what$/i.test(this.type)&&A());var r=this,s=e.result.data||[],u=s.length,a=e.result.places||[],f=a.length,l=e.result.pattern||"",c=t.length===0,p=0,d="",v=new RegExp("("+l+")","gi"),m="",b="",w=12,E="",S="",x=!1,T=function(){k.call(r,this)},C=function(e){return r.hideAutoComplete=!1,g(r,this),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1},L=function(e){h(r,e)};y(this,e);var O=this.favorite.array.length,M=this.history.array.length;this.$content.empty(),c&&(/^where$/i.test(this.type)?(this.$content.append(o.clone(!0)),w--):A());if(c||this.showFavories||!n)for(p=0;p<O;p++)d+=N(this.type,this.favorite.array[p],v,"favorite"),w--;if(c)for(p=0;p<M;p++)w>0&&(d+=N(this.type,this.history.array[p],v,"history"),w--);for(p=0;p<u;p++)this.type==="what"?i.common.accentsTidy(s[p].label.replace(/([\-]{1,})/g," "))==i.common.accentsTidy(this.$input.val().replace(/([\-]{1,})/g," "))&&(S===""?S=s[p].categseo:x=!0):this.type==="where"&&i.common.accentsTidy(s[p].label.replace(/ \(([0-9A-B]{2,3})\)/i,"").replace(/([\-]{1,})/g," "))==i.common.accentsTidy(this.$input.val().replace(/ \(([0-9A-B]{2,3})\)/i,"").replace(/([\-]{1,})/g," "))&&s[p].localType==6&&(E===""?E=s[p].cityseo:x=!0),d+=N(this.type,s[p],v),w--;this.type==="where"&&(this.inputSearch.setWhereUrl(null),!x&&E!==""&&this.inputSearch.setWhereUrl(E)),this.type==="what"&&(this.inputSearch.setWhatUrl(null),!x&&S!==""&&this.inputSearch.setWhatUrl(S));for(p=0;p<f;p++)d+=N(this.type,a[p],v,"places"),w--;this.$content.append(d),this.$li=this.$content.find("li").click(T),this.$li.find("button").click(C).blur(L),this.focusAutoComplete(!0),c||this.required(!0)}return this},hideAutoComplete:!0,placeholder:"",focusAutoComplete:function(e){return e?(this.showFavories=!1,this.$input.addClass("focus"),this.$content.addClass("active"),this.$input.attr("placeholder","")):(this.$input.removeClass("focus"),this.$content.removeClass("active"),this.navPosition=-1,this.$input.attr("placeholder",this.placeholder),this.showFavories=!0),this},lastLabel:"",warningTimeUp:3e3,warningTimeout:null,required:function(e){return e?this.$input.removeClass("required"):this.$input.addClass("required"),e},getDatas:function(e){var t=1;return this.$input.datas?this.$input.datas[e]:null},setDatas:function(e){return this.$input.datas=e||null,this},editInput:function(e,t,n){this.$input.val(this.lastLabel),this.lastLabel&&this.lastLabel.length>0&&this.required(!0);var r=this,i=e.attr("data-reference"),s=function(){L.apply(r,arguments)},o=e.attr("data-cat")||"",u=f;this.type==="where"&&this.inputSearch.setWhereUrl(e.attr("data-cityseo")||null),this.type==="what"&&(A(o),this.inputSearch.setWhatUrl(e.attr("data-categseo")||null));if(i)u=!0,this.setDatas({label:this.lastLabel,reference:i,id:e.attr("data-id"),url:e.attr("data-url"),cat:o});else{var l=e.attr("data-type");u=!l||!/^(local|reverse|proxy)$/i.test(l)?f:l==="proxy"?!0:!1,this.setDatas({label:this.lastLabel,lat:e.attr("data-lat"),lng:e.attr("data-lng"),radius:e.attr("data-radius"),type:l,city:e.attr("data-city"),cat:o})}return a&&a[0]&&(a.attr("checked",u),a[0].setAttribute("checked",u),a[0].checked=u),this.$where&&!n&&O.call(this,!!t),this},$li:null,navPosition:-1,inhibits:!1,notInhibits:function(){return!this.inhibits&&(!this.$where||!this.$where.inhibits)},navgeoloc:function(){var e=this;return C(e)},fromWhat:!1,navigation:function(e){e=e||i.event;if(e.type=="keydown"){var t=e.keyCode||e.charCode||e.which;t=i.parseInt(t,10),!this.inhibits&&t===40&&this.$li&&(this.inhibits=!0,this.navPosition=-1),this.inhibits&&this.$li?t===13?this.available?(k.call(this,this.$li.eq(this.navPosition),!0),this.navPosition=-1,this.available=!1):/^what$/i.test(this.type)?(this.available=!1,this.inhibits=!0,O.call(this,!0),this.focusAutoComplete()):this.inhibits=!1:(this.$li.removeClass("hover"),t===40?this.navPosition++:t===38?this.navPosition--:(this.navPosition=-1,this.inhibits=!1),this.navPosition=i.Math.min(i.Math.max(this.navPosition,-1),this.$li.length-1),this.navPosition>=0&&this.$content.hasClass("active")?k.call(this,this.$li.eq(this.navPosition).addClass("hover"),!0,!0):this.inhibits=!1):t===13&&/^what$/i.test(this.type)?(this.available=!1,this.inhibits=!0,O.call(this,!0),this.focusAutoComplete()):this.fromWhat?(this.fromWhat=!1,t!==13&&(this.inhibits=!1)):this.inhibits=!1}return this.inhibits}},P.prototype={uniqueObjects:function(e){var t=[],n=this.array.length,r=0,i=0,s=0,o=function(e,t,n){var r=!1,i=typeof e;if(i===typeof t)if(/^(string|number|boolean|undefined)$/.test(i))r=e===t;else if(/^object$/.test(i))if(e===null&&t===null)r=!0;else if(e&&t)if(n&&n.length>0)for(var s=0,u=n.length;s<u;s++){r=o(e[n[s]],t[n[s]]);if(!r)break}else for(var a in e){r=o(e[a],t[a]);if(!r)break}else r=!1;else/^function$/.test(i)&&(r=e.toString()===t.toString());return r},u=!1;for(;r<n;r++){s=t.length;if(s>0){u=!0;for(i=0;i<s;i++)if(o(this.array[r],t[i],e)){u=!1;break}u&&(t[s]=this.array[r])}else t[s]=this.array[r]}return this.array=t,this},mergeFirst:function(e){var t=0,n=this.array.length,r=(new i.Date).getTime();for(t=0;t<n;t++)e[e.length]=this.array[t];n=e.length;for(t=0;t<n;t++)e[t].id||(e[t].id=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=r+t,e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10),e[t].id+="",e[t].id+=i.Math.floor(i.Math.random()*10)),e[t].date||(e[t].date=r),this.array[t]=e[t];return this},getBy:function(e,t,n){var r=[],i=[];for(var s=0,o=this.array.length;s<o;s++)this.array[s]&&this.array[s][e]&&this.array[s][e]==t?r[r.length]=this.array[s]:n&&(i[i.length]=this.array[s]);return n&&(this.array=i),r},reduce:function(e,t){var n=this.array.length,r=e.length,i=0,s=0,o=!0,u=!0,a=null;reduceArray=[];for(i=0;i<n;i++){o=!0;for(s=0;s<r;s++){u=!0;if(t){for(a in t)if(a!=="id")if(!e[s]||!!e[s][t[a]]&&!this.array[i][a]||!e[s][t[a]]&&!!this.array[i][a]||!!e[s][t[a]]&&(typeof e[s][t[a]]!=typeof this.array[i][a]||e[s][t[a]]!==this.array[i][a])){u=!1;break}}else for(var f in this.array[i])if(f!=="id")if(!e[s]||!!e[s][f]&&!this.array[i][f]||!e[s][f]&&!!this.array[i][f]||!!e[s][f]&&(typeof e[s][f]!=typeof this.array[i][f]||e[s][f]!==this.array[i][f])){u=!1;break}if(u){o=!1;break}}o&&(reduceArray[reduceArray.length]=this.array[i])}return this.array=reduceArray,this},sortByDate:function(e,t){return(e.date||0)<(t.date||0)?1:-1},limit:function(e){var t=[],n=0,r=this.array.length;e=e>r?r:e,this.array.sort(this.sortByDate);for(;n<e;n++)t[n]=this.array[n];return t}},H.fn.init.prototype=H.fn,a.click(l),H}(window)}),define("action",["autocomplete","login"],function(e,t){require(["jsonrcp"],function(n){return function(n,r){var i=function(e){return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1},s=t(),o=!1,u=function(){o=!0},a={manageFavorites:function(e){return this.favoritesTargets[this.favoritesTargets.length]=e,this},favoritesTargets:[]},f=function(){var t=e("#who","#whatDropDown","what"),r=t.inputSearch,f=n.$C.get("#search"),l=t.$input,c=r.getInput(),h=$('<input type="hidden" class="sending"/>'),p=!0,d={},v=function(){d.x=r.getLng(),d.y=r.getLat(),d.label=c.val(),d.cat=t.getDatas("cat"),d.categseo=r.getWhatUrl(),d.cityseo=r.getWhereUrl(),d.geolocneed=r.getNeedGeo();var e=null;c.datas!==null&&(e=c.datas.city),d.radius=r.getRadius(),d.city=r.getCity()||e,d.who=l.val(),n.shore.set("searchQuery",d)},m=function(){var e=$("#fgeoloc").val()==="1",t=d.who&&d.who.length>0||!r.isEmpty()||e,i=n.location.host,s="",o,u,a=!0;if(t){p=!1;if(d.categseo&&d.cityseo)n.location=i.replace(/([^\.]+).(.*)/,"//www.$2")+"/"+d.cityseo+"/"+d.categseo;else{f.attr("action",i.replace(/([^\.]+).(.*)/,(e?"https:":"")+"//www.$2")+"/search"),f.find(".sending").remove();for(s in d)o=d[s],a=!0,s==="geolocneed"&&o===0&&(a=!1),s!=="cityseo"&&s!=="categseo"&&s!=="fgeoloc"&&a&&(o||n.parseInt(o,10)===0)&&(u=h.clone(!0),u.attr("name",s),u.val(o),f.append(u));f.submit()}}return t},g=function(e){var t=!0,n=$("#fgeoloc").val()==="1";return p&&(t=i(e),y()&&(!r.isEmpty()&&r.isUpdate()||n?t=m():r.updatePlace(m))),t},y=function(){v();var e=!0,n=$("#fgeoloc").val()==="1";return t.required(e)&&(o||t.notInhibits())||n};return f.submit(g).find('button[type="submit"]').mousedown(u).keydown(u),a.manageFavorites=function(e){t.$where.manageFavoritesOut([e])},t.$where.manageFavoritesOut(a.favoritesTargets),document.location.search.indexOf("geolocneed=1")>-1&&t.$where.navgeoloc(),n.$C.get("#showPopinLogin a").click(s.showPopinLogin),n.$C.get(".btnclosepopin").click(s.closePopin),n.$C.set(".logout").click(s.logout),this};return n.$C.$doc.ready(f),a}(window)})}),define("contact",["jsonrcp","action","popin"],function(e,t,n){return function(t,r){var i=function(e,n,r,i,s,o){var u=new RegExp("^(0[1-9])(?:[ _.-]?([0-9]{2})){4}$"),a=!0;o===""&&(t.$C.set("#monmail").addClass("required"),a=!1),e===""&&(t.$C.set("#contactemail").addClass("required"),a=!1);if(n===""||n==="Sélectionnez")t.$C.set("#objetemail").addClass("required"),a=!1;return r===""?(t.$C.set("#phoneemail").addClass("required"),t.$C.get("#contactForm input[type='tel']").parent().find("p strong").text('Champ "Téléphone" requis'),a=!1):r!==null&&(r.length!=10||!u.test(r))&&(t.$C.set("#phoneemail").addClass("required"),t.$C.get("#contactForm input[type='tel']").parent().find("p strong").text("Veuillez saisir 10 chiffres"),a=!1),i===""&&(t.$C.set("#nameemail").addClass("required"),a=!1),s===""&&(t.$C.set("#messageemail").addClass("required"),a=!1),a},s=function(){var e=t.$C.set("#objetemailsec");e.length>0&&e.parent().parent().removeClass("none")},o=function(n){n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation();var r=t.location.href,s=t.$C.set("#contactPro").val(),o=t.$C.set("#contactemail").val(),a=t.$C.set("#objetemail").val(),f=t.$C.set("#phoneemail").val(),l=t.$C.set("#nameemail").val(),c=t.$C.set("#messageemail").val(),h=i(o,a,f,l,c,s);return h===!0&&e("/Site/details/contact","sendToContact",[o,a,s,f,l,c,r],u),!1},u=function(e){e.hasOwnProperty("result")?(t.$C.set(".msg").attr("class","msg success fade max10 iconyes after active").text(e.result.msg),t.setTimeout(f,3e3)):t.$C.set(".msg").attr("class","msg fade max10 iconno after active").text("Erreur. Mail non envoyé")},a=function(){var e=t.$C.set("#my_iframe_ct").contents().find("body").text(),n=t.$C.set("#my_iframe_ct").contents().find("body").attr("class");t.setTimeout(function(){if(e===""||!e||n==="page404")a();else{var r=JSON.parse(e);if(r.errors.length===0)t.$C.set(".msg").attr("class","msg success fade max10 iconyes after active").text("Message envoyé."),t.setTimeout(f,3e3);else{for(var i=0;i<r.errors.length;i++)t.$C.get("#"+r.errors[i]).addClass("required"),i===r.errors.length-1&&$("#my_iframe_ct").contents().find("body").text("");t.$C.set(".msg").attr("class","msg fade max10 iconno after active").text("Erreur. Mail non envoyé"),a()}}},5e3),t.$C.set("input,textarea").focus(function(){$(this).removeClass("required")})},f=function(){t.$C.$html.removeClass("on"),t.$C.$body.removeClass("transportbox contactusbox contactformbox")},l="/Site/default/contact",c=function(e){return prevUrl=t.$C.get("#datarefurl").data("refurl"),t.$C.get("#linkCorrection").click(function(){e.contactformbox("correction",prevUrl)}),t.$C.get("#serviceClient").click(function(){e.contactformbox("serviceclient",prevUrl)}),t.$C.set(".linkCommercial").click(function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var n=$(this).attr("rel");return n!==""?e.contactformbox(n,prevUrl):e.contactformbox("commercial",prevUrl),!1}),t.$C.set(".linkedForm").click(function(n){n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation();var r=$(this),i=r.attr("id");return i==="linkCommercial"?e.contactformbox("commercial",prevUrl):i==="linkPartenariat"?e.contactformbox("partenariat",prevUrl):i==="linkRecrutement"?e.contactformbox("recrutement",prevUrl):i==="linkProPage"&&(r.closest("article").data("pro")==="pro"?t.location.href="/profile/mesfiches":t.location.href="/registration?r=pro&cksrc=footer-info#pro"),!1}),t.$C.set(".page3 .iconhelp").click(function(){e.contactformbox("help",prevUrl)}),$("#my_iframe_ct").onload=a(),e},h=function(){return c(this),this.contactformshare=function(r,s,o){return o=o||t.location.href,function(r,s,o){e(l,"contactShareBuild",[r,s,o],function(a){var f=function(n){n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation();var a=t.$C.set("#contactemail").val(),f=t.$C.set("#monemail").val(),c=t.$C.set("#nameemail").val(),h=t.$C.set("#messageemail").val(),p=i(a,null,null,c,h,f);return p&&e(l,"share",[r,s,a,f,c,h,o],u),!1};n(a,"contactform","ffpopin"),t.$C.set("#contactForm input, #contactForm textarea").focus(function(){$(this).removeClass("required")}),t.$C.set("#contactForm").submit(f)})}(r,s,o),this},this.contactformbox=function(r,s){return function(r){e(l,"contactForm",[r],function(o){r==="recrutement"&&a();var f=function(n){var o=t.$C.set("#urldel").val(),a=t.$C.set("#contactemail").val(),f=t.$C.set("#objetemail").val(),c=t.$C.set("#phoneemail").val(),h=t.$C.set("#nameemail").val(),p=t.$C.set("#messageemail").val(),d=null,v=i(a,f,c,h,p),m=!0;return r!=="recrutement"&&(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),m=!1),r==="recrutement"&&(d=t.$C.set("#attachement").val()),v&&(t.$C.set(".btsendem").hide(),e(l,"contactUs",[r,a,f,"",c,h,p,o,d,s],u)),m};n(o,"contactform","ffpopin"),t.$C.set("#contactForm input, #contactForm textarea").focus(function(){$(this).removeClass("required")}),t.$C.set("#objetemail").change(function(){var e=$(this).val();e==="contact:SupAU"?t.$C.set("#urldel").parent().parent().removeClass("none"):t.$C.set("#urldel").parent().parent().addClass("none")}),t.$C.set("#contactForm").submit(f)})}(r),this},this.contactformdetails=function(){var r=t.$C.get("#detail-top").data("info");return e("/Site/details/contact","contact",[parseInt(r.categories,10),r.comCode],function(e){n(e,"contactform","ffpopin"),t.$C.set("#objetemail").change(s),t.$C.set("#contactForm").submit(o)}),this},this};return h()}(window)}),define("share",["jsonrcp","action","contact"],function(e,t,n){return function(t,r){var i="/Site/default/sharer",s=function(){t.$C.get(".iconshare").click(function(){u()})},o=function(){t.$C.$html.removeClass("on"),t.$C.$body.removeClass("socialsharebox")},u=function(){e(i,"buildShare",[t.location.href],function(e){t.$C.get("#generic_popin").html(e.result),t.setTimeout(function(){t.$C.get("#generic_popin").attr("class","popin socialshare").find(".closepopin").click(o),t.$C.$html.addClass("on"),t.$C.$body.addClass("socialsharebox"),t.common.adjustPopin(),t.$C.set("#sharemail").click(function(){var e=$(this).attr("rel"),t=$("h1.title").text()?$("h1.title").text():$("h2.title").text();n.contactformshare(t,e)})},100)})},a=function(){return s(),this};return a()}(window)}),define("guides",["jsonrcp","login","devis","action","share","popin"],function(t,n,r,i,s,o){return function(r,i){var s=null,o={serviceUrl:"/Account/data/jaime",setJaimeCounter:function(e,t){counter=r.parseInt(e.find(".front").text(),10),e.find(".front").text(t),counter>t?(e.removeClass("liked"),t===0&&e.addClass("null")):counter<t&&(e.addClass("liked"),e.removeClass("null"))},JaimePLus:function(e){var n=r.JSON.parse(e.attr("data-info")),i=this,s=0,o=r.$C.$body,u=[n[0]];t(this.serviceUrl,"jaimePlusArticle",u,function(t){typeof t.error=="undefined"&&t.result.code=="ok"&&(e.removeClass("liked"),s=r.parseInt(e.find(".front").text(),10),s--,e.find(".front").text(s),s===0&&e.addClass("null"),e.attr("id")==="detail-bottom"&&i.setJaimeCounter($("#detail-top"),s),e.attr("id")==="detail-top"&&i.setJaimeCounter($("#detail-bottom"),s))})},Jaime:function(e){var i=r.JSON.parse(e.attr("data-info")),o=0,u=this,a=$("#generic_popin"),f=r.$C.$body;t(this.serviceUrl,"jaimeArticle",i,function(t){if(typeof t.error=="undefined"&&t.result.code=="ok"){e.addClass("liked"),e.removeClass("null"),o=e.find(".front").text();var i=r.parseInt(o,10)+1;e.find(".front").text(i),e.attr("id")==="detail-bottom"&&u.setJaimeCounter($("#detail-top"),i),e.attr("id")==="detail-top"&&u.setJaimeCounter($("#detail-bottom"),i)}else t.result.msg==="session_trash"&&(s||(s=n()),s.sessTrash(t.result.page))})}},u=r.$C.get("#summaryList"),a=r.$C.get("#displaySummary"),f=function(){u.hasClass("activechild")?(a.removeClass("iconplus iconless").text("Voir tout le sommaire").addClass("iconplus"),u.removeClass("activechild")):(a.removeClass("iconplus iconless").text("Réduire le sommaire").addClass("iconless"),u.addClass("activechild"))},l=function(){var e=$(this);e.hasClass("liked")?o.JaimePLus(e):o.Jaime(e)},c=function(){if($("#generic_popin").is(":empty")){var e="/outils/calculatrice/surface",n=$("#generic_popin"),i=r.$C.$body;n.html()===""&&t(e,"getCalculateSurfaceHtml",[],function(e){n.attr("class","popin contactform"),n.empty(),n.append(e.result),r.setTimeout(function(){r.$C.$html.addClass("on"),i.addClass("contactformbox"),r.common.adjustPopin()},200),$(".closepopin").off("click").click(function(){r.$C.$html.removeClass("on"),i.removeClass("contactformbox")}),require(["outils"],function(){})})}},h=function(){var e="/outils/calculatrice/beton",n=$("#generic_popin"),i=r.$C.$body;n.html()===""&&t(e,"getCalculateBetonHtml",[],function(e){n.attr("class","popin contactform"),n.empty(),n.append(e.result),r.setTimeout(function(){r.$C.$html.addClass("on"),i.addClass("contactformbox"),r.common.adjustPopin()},200),$(".closepopin").off("click").click(function(){r.$C.$html.removeClass("on"),i.removeClass("contactformbox")}),require(["outils"],function(){})})},p=function(){var t=$("#generic_popin"),n=r.$C.$body,i=$(this).attr("data-extra"),s='<object type="application/x-shockwave-flash" data="'+i+'" width="800" height="600">'+'<param name="movie" value="'+i+'" />'+'<param name="quality" value="high" />'+"</object>";t.attr("class","popin contactform ffpopin"),t.empty(),t.append(e.result),r.setTimeout(function(){r.$C.$html.addClass("on"),n.addClass("contactformbox"),r.common.adjustPopin()},200),$(".closepopin").off("click").click(function(){r.$C.$html.removeClass("on"),n.removeClass("contactformbox")})},d=function(){var e=r.$C.get(".seemore");e.hasClass("active")?(e.removeClass("active"),r.$C.get(".seemorebtn").html("Voir plus...")):(e.addClass("active"),r.$C.get(".seemorebtn").html("Voir moins"))},v=function(){r.$C.get(".iconheart").off("click").click(l),r.$C.get("calculatriceSurface").click(c),r.$C.get("calculatriceBeton").click(h),r.$C.get(".extra-content").click(p),r.$C.get(".seemorebtn").click(d),r.$C.get("#printableContent").click(function(){r.print()}),a.click(f)},m=function(){return v(),this};return m()}(window)});